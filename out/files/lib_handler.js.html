<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>lib&#x2F;handler.js</title>
    <link rel="stylesheet" href="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;3.8.0pr2&#x2F;build&#x2F;cssgrids&#x2F;cssgrids-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="..&#x2F;assets/favicon.png">
    <script src="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;combo?3.8.0pr2&#x2F;build&#x2F;yui&#x2F;yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="..&#x2F;assets/css/logo.png" title=""></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="..&#x2F;classes/Handler.html">Handler</a></li>
            
                <li><a href="..&#x2F;classes/Server.html">Server</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="..&#x2F;modules/knotter.html">knotter</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: lib&#x2F;handler.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
&#x2F;*
 * Knotter Handler
 *
 * @author Patrice FERLET
 * @licence GPLv3
 * @module knotter
 *
 *&#x2F;


&#x2F;**
 * Handler that will match route to method.
 * This is the class to implement on project.
 * Minimum required is &quot;route&quot; and one of HTTP method
 * as get, post, put, delete...
 *
 * Handler has this properties to work:
 *
 *  - params.args =&gt; that matches regexp on url
 *  - params.get =&gt; options given by ?argname=argvalue&amp;...
 *  - postdata =&gt; object having post data
 *  - response =&gt; to write response
 *  - request =&gt; the current request
 *
 * @class Handler
 * @constructor
 * @param {Object} options ({route:... , get: funtion(){}... } 
 *&#x2F;
var Handler = function(options){
    this.params = {args: [], get: {}};
    this.postdata = null;
    this.route = options[&#x27;route&#x27;];
    this.get = options[&#x27;get&#x27;];
    this.post= options[&#x27;post&#x27;];
    this.put= options[&#x27;put&#x27;];
    this.useSessions = options[&#x27;useSessions&#x27;] || false;
    this[&#x27;delete&#x27;]= options[&#x27;delete&#x27;];
    this.__reg = null;
    this.response = null;
    this.request = null;
};

&#x2F;**
 * Property that handle arguments (GET and url parts)
 *
 * @property {Object} params
 * @default {args: [], get: {}}
 * @example
 *
 *      var h = new knotter.Handler({
 *          route: &#x27;&#x2F;article&#x2F;(.*?)&#x2F;(\\d+)&#x27;,
 *          get: function (){
 *
 *              &#x2F;&#x2F; get params captured by (.*?)
 *              var param1 = this.params.args[1];
 *
 *              &#x2F;&#x2F;get params captured by (\d+)
 *              var param2 = this.params.args[2];
 *
 *
 *              &#x2F;&#x2F;if there is ?foo=bar:
 *              var gets = this.params[&#x27;get&#x27;]
 *              console.log(gets[&#x27;foo&#x27;]); &#x2F;&#x2F;writes &quot;bar&quot; on console
 *              this.response.end(&quot;ok&quot;)
 *          };
 *      })
 *&#x2F;
Handler.prototype.params = {args: [], get: {}};


&#x2F;**
 * Postdata object that map datas sent via POST method
 *
 * @property {Object} postdata
 *&#x2F;
Handler.prototype.postdata = null;

&#x2F;**
 * Route to handle (regexp)
 * 
 * @property {String} route
 *&#x2F;
Handler.prototype.route = null;

&#x2F;**
 * GET method handler, to be set if handler should respond
 * to GET
 *
 * @method get
 * @default null
 *&#x2F;
Handler.prototype.get = null;

&#x2F;**
 * POST method handler, to be set if handler should respond
 * to POST
 *
 * @method post
 * @default null
 *&#x2F;
Handler.prototype.post = null;

&#x2F;**
 * PUT method handler, to be set if handler should repond
 * to PUT
 *
 * @method put
 * @default null
 *&#x2F;
Handler.prototype.put = null;

&#x2F;**
 * DELETE method handler, to be set if handler should repond
 * to DELETE
 *
 * @method delete
 * @default null
 *&#x2F;
Handler.prototype[&#x27;delete&#x27;] = null;

&#x2F;**
 * Boolean to enable session on handler. 
 *
 * @property {bool} useSessions
 * @default false
 * @example
 * 
 *      var h = new knotter.Handler({
 *          useSessions: true,
 *          route: &#x27;&#x2F;user&#x27;,
 *
 *          get: function () {
 *              try {
 *                  &#x2F;&#x2F;fetch &quot;user&quot; from session
 *                  var user = this.sessions.get(&#x27;username&#x27;)
 *                  if (user) {
 *                      this.response.write(&quot;Hi &quot;+ user + &quot;&lt;br &#x2F;&gt;&quot;);
 *                  }
 *              } 
 *              catch (e) {
 *                  &#x2F;&#x2F;useSessions was set to false ?
 *                  console.log(e);
 *              }
 *              &#x2F;&#x2F;anyway, show a form to set username
 *              this.response.write(&#x27;&lt;form action=&quot;&quot;&gt;&#x27;
 *                      + &#x27;Type username: &lt;input type=&quot;text&quot; name=&quot;user&quot; &#x2F;&gt;&#x27;
 *                      + &#x27;&lt;input type=&quot;submit&quot; value=&quot;send&quot; &#x2F;&gt;&lt;&#x2F;form&gt;&#x27;);
 *              this.response.end();
 *
 *          },
 *          
 *          post: function () {
 *              &#x2F;&#x2F;if get username from form
 *              if (this.postdata[&#x27;user&#x27;]) {
 *                  this.sessions.set(&#x27;username&#x27;, this.postdata[&#x27;user&#x27;]);
 *              }
 *
 *              &#x2F;&#x2F;redirect to &#x2F;user
 *              this.response.writeHead(302, {
 *                  &#x27;Location&#x27;: &#x27;&#x2F;user&#x27;
 *              });
 *              this.response.end();
 *          }
 *      })
 *&#x2F;
Handler.prototype.useSessions = false;



&#x2F;**
 * Handler sessions.session to get&#x2F;set values
 *
 * @property {Function} sessions
 * @throws Exception if useSessions is set to false
 *&#x2F;
Handler.prototype.sessions = function (){
    throw new Exception(&#x27;sessions not activated for this handler&#x27;);    
};

&#x2F;**
 * Response handler, object taken from http.Response
 *
 * @property {http.Response} response
 *&#x2F;
Handler.prototype.response = null;

&#x2F;**
 * Request handler, object taken from http.Request
 *
 * @property {http.Request} request
 *&#x2F;
Handler.prototype.request = null;




module.exports.Handler = Handler;

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="..&#x2F;assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="..&#x2F;assets/js/yui-prettify.js"></script>
<script src="..&#x2F;assets/../api.js"></script>
<script src="..&#x2F;assets/js/api-filter.js"></script>
<script src="..&#x2F;assets/js/api-list.js"></script>
<script src="..&#x2F;assets/js/api-search.js"></script>
<script src="..&#x2F;assets/js/apidocs.js"></script>
</body>
</html>
